#!/bin/bash

desc() {
        echo ''
        echo -e "\033[1m${1}...\033[0m"
}

dt=`date +%T`
desc "Lets begin (${dt})"

desc 'Removing temp folder contents'
#rm -rf ./tmp/*

desc 'Rsync contents'
#rsync -rupEogtz --exclude-from=./excludes ../../ tmp/ > /dev/null

desc 'Preparing js'
#mkdir tmp/public_html/js

desc 'Compressing javascript'
echo 'jQuery...'
java -jar tmp/utils/compiler.jar --js ../../public_html/js/jquery.js --warning_level QUIET > tmp/public_html/js/jquery.js
gzip -c9 tmp/public_html/js/jquery.js > tmp/public_html/js/jquery.js.gz

echo 'Index script...'
java -jar tmp/utils/compiler.jar --js ../../public_html/js/index.js --warning_level QUIET --externs tmp/public_html/js/jquery.js --compilation_level ADVANCED_OPTIMIZATIONS > tmp/public_html/js/index.js
gzip -c9 tmp/public_html/js/index.js > tmp/public_html/js/index.js.gz
