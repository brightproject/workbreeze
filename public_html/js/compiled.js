var f=false;function i(a){if(a<10)a="0"+a;return a};var j=[];function k(){$(".l").each(function(){$(this).hasClass("lp")&&undefined!=$(this).attr("lp")&&$(this).attr({placeholder:l($(this).attr("lp"))});$(this).hasClass("lv")&&undefined!=$(this).attr("lv")&&$(this).html(l($(this).attr("lv")))})}function m(){if(!f)return 0;try{j=JSON.parse(localStorage.getItem("lang"))}catch(a){return 0}if(!j)return 0;if("undefined"==typeof j||"undefined"==typeof j.v)return 0;return Math.floor(j.v)}
function l(a){if("undefined"==typeof j.vl)return"";if("string"!=typeof j.vl[a])return"";return j.vl[a]};var n=0,o,p,q,r,s,t,u,v=[],w=[],x=[],y=[],z=[];function A(){for(;y.length>20;){tmpEl=y.shift();tmpEl.fadeOut("slow",function(){$(this).remove()})}}function B(){C();$.ajax({url:"/up",type:"POST",data:{stamp:n},dataType:"json",success:function(a){D(3E4);E(a,false)},error:function(){D(3E4)}})}function C(){null!=p&&clearTimeout(p)}function F(a){null!=o&&clearTimeout(o);o=setInterval(function(){x.length>0&&G(false)},a)}function D(a){C();p=setInterval(function(){B()},a)}
function G(a){var c=x.pop();y.push(c);c.hide().prependTo(s);a?c.show():c.slideDown("slow",function(){H($(this))});A()}
function E(a,c){for(var d=a.length-1;d>=0;d--){var b={id:a[d].i,a:a[d].s,c:a[d].st,title:a[d].t,e:a[d].d},g=c;if(b.c>n)n=b.c;var e=r.clone();e.attr({site:b.a}).hide();lnk=$("<a>").addClass("sico").addClass("sico_"+z[b.a].b).attr({href:"/jobs/"+z[b.a].b+"/"+b.id+".html",title:b.title+" "+l("on")+" "+z[b.a].name}).html(b.title).appendTo($("li.title",e));$("li.desc",e).html(b.e);b=new Date(b.c*1E3);$("li.time",e).html(i(b.getHours())+":"+i(b.getMinutes()));x.push(e);g&&G(g)}}
function H(a){var c=$(".title",a).html()+$(".desc",a).html();c=c.toLowerCase();var d=false;if(0!=v.length)for(var b=0;b<v.length;b++){if(c.indexOf(v[b].toLowerCase())>=0){d=true;break}}else d=true;if(w.indexOf(a.attr("site"))>=0&&d){if(!a.hasClass("jsel")||a.hasClass("jrem")){a.removeClass("jrem").addClass("jsel");a.animate({opacity:1})}}else if(!a.hasClass("jrem")||a.hasClass("jsel")){a.removeClass("jsel").addClass("jrem");a.animate({opacity:0.2})}}
function I(){for(var a=0;a<y.length;a++)H(y[a])}function J(){$("#keyword, #sites").animate({opacity:0.8},function(){$(this).animate({opacity:1})});var a=$("#keyword").val().trim();w=[];$("input","#sites").each(function(){$(this).attr("checked")&&w.push($(this).attr("site"))});v=""==a?[]:a.split(",");I()}
function K(){f="undefined"!=typeof localStorage;r=$("ul.job:first");s=$("#right");t=$("#play");u=$("#pause");u.click(function(){u.slideUp("slow");t.slideDown("slow");x=[];C()});t.click(function(){t.slideUp("slow");u.slideDown("slow");n=Math.round((new Date).getTime()/1E3);D(5E3)});F(5E3);D(5E3);$("#right > *").remove();$.ajax({url:"/init",type:"POST",data:{lang:m()},dataType:"json",success:function(a){if("undefined"!=typeof a.l){j=a.l;f&&localStorage.setItem("lang",JSON.stringify(j))}k();for(var c=
a.s,d=$("#sites"),b=0;b<c.length;b++){var g=c[b],e=g.i,h={b:g.f,name:g.n,url:g.u};z[e]=h;w.push(e);g=$("<input />").attr({type:"checkbox",id:"c"+e,site:e,checked:"checked"}).click(J);e=$("<label></label>").attr({"for":"c"+e}).addClass("sico").addClass("sico_"+h.b).html(h.name);h=$("<li></li>");g.appendTo(h);e.appendTo(h);h.appendTo(d)}E(a.j,true)}});$("#keyword").keyup(function(a){null!=q&&clearTimeout(q);if(a.keyCode==13)J();else q=setTimeout(J,2E3)})}$(function(){K()});
